window.__require=function t(e,o,n){function r(c,u){if(!o[c]){if(!e[c]){var a=c.split("/");if(a=a[a.length-1],!e[a]){var l="function"==typeof __require&&__require;if(!u&&l)return l(a,!0);if(i)return i(a,!0);throw new Error("Cannot find module '"+c+"'")}c=a}var f=o[c]={exports:{}};e[c][0].call(f.exports,function(t){return r(e[c][1][t]||t)},f,f.exports,t,e,o,n)}return o[c].exports}for(var i="function"==typeof __require&&__require,c=0;c<n.length;c++)r(n[c]);return r}({auth_mgr:[function(t,e,o){"use strict";cc._RF.push(e,"947e1wNBttARa4P4zke7p2K","auth_mgr");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,c=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,n);else for(var u=t.length-1;u>=0;u--)(r=t[u])&&(c=(i<3?r(c):i>3?r(e,o,c):r(e,o))||c);return i>3&&c&&Object.defineProperty(e,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var c=cc._decorator,u=c.ccclass,a=(c.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.onLoad=function(){this.updateManage()},e.prototype.updateManage=function(){var t=this;if("function"==typeof wx.getUpdateManager){var e=wx.getUpdateManager();e.onCheckForUpdate(function(e){e.hasUpdate?wx.showModal({title:"\u66f4\u65b0\u63d0\u793a",content:"\u6709\u65b0\u7248\u672c\u6b63\u5728\u4e0b\u8f7d\u4e2d\uff01"}):t.login()}),e.onUpdateReady(function(){wx.showModal({title:"\u66f4\u65b0\u63d0\u793a",content:"\u65b0\u7248\u672c\u5df2\u7ecf\u51c6\u5907\u597d\uff0c\u662f\u5426\u91cd\u542f\u5e94\u7528\uff1f",showCancel:!1,success:function(o){o.confirm&&(e.applyUpdate(),t.login())}})}),e.onUpdateFailed(function(){wx.showModal({title:"\u66f4\u65b0\u63d0\u793a",content:"\u65b0\u7248\u672c\u4e0b\u8f7d\u5931\u8d25\uff0c\u8bf7\u5220\u9664\u56fe\u6807\u91cd\u65b0\u641c\u7d22\u6216",showCancel:!1,success:function(t){t.confirm&&wx.exitMiniProgram()}})})}else wx.showModal({title:"\u66f4\u65b0\u63d0\u793a",content:"\u4e3a\u4e86\u6e38\u620f\u6b63\u5e38\u8fd0\u884c\uff0c\u5efa\u8bae\u60a8\u5148\u5347\u7ea7\u81f3\u5fae\u4fe1\u6700\u9ad8\u7248\u672c\uff01",showCancel:!1,success:function(t){t.confirm&&wx.exitMiniProgram()}})},e.prototype.login=function(){var t=this;wx.checkSession({success:function(){t.init()},fail:function(){t.getWxLoginCode()}})},e.prototype.getWxLoginCode=function(){var t=this;wx.login({success:function(e){if(console.log(e),"function"==typeof wx.createUserInfoButton){console.log("createUserInfoButton");var o=wx.getSystemInfoSync(),n=o.windowWidth,r=o.windowHeight,i=wx.createUserInfoButton({type:"text",text:"\u6388\u6743",style:{left:n/2-150,top:r/2-40,width:300,height:80,lineHeight:80,backgroundColor:"#FFFFFF",color:"#000000",textAlign:"center",fontSize:30,borderRadius:5}});i.onTap(function(e){console.log(e),e.errMsg.indexOf("auth deny")>-1||e.errMsg.indexOf("auth denied")>-1?t.getWxSetting():(wx.setStorageSync("userInfo",e.userInfo),i.hide(),t.init())})}else wx.getUserInfo({fail:function(e){e.errMsg.indexOf("auth deny")>-1||e.errMsg.indexOf("auth denied")>-1?t.getWxSetting():t.init()}})},fail:function(t){console.log("\u8c03\u7528login",t)}})},e.prototype.getWxSetting=function(){var t=this;wx.getSetting({success:function(e){console.log(e);var o=e.authSetting;!0===o["scope.userInfo"]?t.init():!1===o["scope.userInfo"]?wx.openSetting({success:function(){}}):"function"==typeof wx.authorize&&wx.authorize({scope:"scope.record",fail:function(t){(t.errMsg.indexOf("auth deny")>-1||t.errMsg.indexOf("auth denied")>-1)&&wx.openSetting({success:function(){}})}})},fail:function(t){console.log("\u8c03\u7528getSetting",t)}})},e.prototype.init=function(){var t=wx.getLaunchOptionsSync();console.log("\u9996\u6b21\u5f00\u542f launchOption"),console.log(t),cc.director.loadScene("Home")},i([u],e)}(cc.Component));o.default=a,cc._RF.pop()},{}],config:[function(t,e,o){"use strict";cc._RF.push(e,"a0b7de5B7lL9anqnb7ZENIs","config"),Object.defineProperty(o,"__esModule",{value:!0}),o.default={gameId:"obg-cfrmfuc1",secretKey:"425b020371033a23ef31ad8c1386fcc444f98470",url:"cfrmfuc1.wxlagame.com",openId:function(){for(var t=Date.now().toString(36),e=0;e<7;e++)t+=Math.ceil(Math.random()*Math.pow(10,4)).toString(36);return t}(),matchCode:"match-fdvxk1tc"},cc._RF.pop()},{}],entryRoomButtton:[function(t,e,o){"use strict";cc._RF.push(e,"42070fyBr1BH6mab0vTgHGy","entryRoomButtton");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,c=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,n);else for(var u=t.length-1;u>=0;u--)(r=t[u])&&(c=(i<3?r(c):i>3?r(e,o,c):r(e,o))||c);return i>3&&c&&Object.defineProperty(e,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var c=cc._decorator,u=c.ccclass,a=c.property,l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.submitButton=null,e.editBox=null,e.onSubmit=null,e.onButtonClick=null,e}return r(e,t),e.prototype.start=function(){var t=this;this.submitButton&&this.submitButton.node.on(cc.Node.EventType.TOUCH_START,function(){return t.onSubmit&&t.onSubmit(t.editBox.string)})},i([a(cc.Button)],e.prototype,"submitButton",void 0),i([a(cc.EditBox)],e.prototype,"editBox",void 0),i([u],e)}(cc.Component);o.default=l,cc._RF.pop()},{}],frame_logic:[function(t,e,o){"use strict";cc._RF.push(e,"81867Mt30lJdIpxfZjstq1p","frame_logic"),Object.defineProperty(o,"__esModule",{value:!0}),o.calcFrame=void 0,o.calcFrame=function(t){console.log(t)},cc._RF.pop()},{}],global:[function(t,e,o){"use strict";cc._RF.push(e,"40bf01uMLlIXJhvrqIewLH1","global"),Object.defineProperty(o,"__esModule",{value:!0});o.default=new function(){this.gameId="",this.room=null},cc._RF.pop()},{}],home_mgr:[function(t,e,o){"use strict";cc._RF.push(e,"89c30ECN1FFfKESrYQ7a/Sw","home_mgr");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,c=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,n);else for(var u=t.length-1;u>=0;u--)(r=t[u])&&(c=(i<3?r(c):i>3?r(e,o,c):r(e,o))||c);return i>3&&c&&Object.defineProperty(e,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var c=t("../ui/entryRoomButtton"),u=t("../util"),a=t("../config"),l=t("../global"),f=cc._decorator,s=f.ccclass,p=f.property,d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.iconSprite=null,e.nameRichText=null,e.createRoomNode=null,e.matchNode=null,e.joinRoomNode=null,e.lockSubmit=!1,e.timer=void 0,e.user="",e}return r(e,t),e.prototype.onLoad=function(){this.initProfile(),this.initListener()},e.prototype.initProfile=function(){var t=wx.getStorageSync("userInfo");this.createImage(this.iconSprite,t.avatarUrl),this.nameRichText.string=t.nickName,this.user=JSON.stringify(t)},e.prototype.createImage=function(t,e){var o=wx.createImage();o.onload=function(){var e=new cc.Texture2D;e.initWithElement(o),t.spriteFrame=new cc.SpriteFrame(e)},o.src=e},e.prototype.initListener=function(){var t=this;this.initSDK(),this.matchNode.onSubmit=function(){return!t.lockSubmit&&t.matchPlayers(a.default.matchCode)},l.default.room&&(l.default.room.onUpdate=function(){return t.onRoomUpdate()})},e.prototype.onRoomUpdate=function(){l.default.room.roomInfo&&l.default.room.roomInfo.playerList&&l.default.room.roomInfo.playerList.find(function(t){return t.id===MGOBE.Player.id})&&this.loadRoomScene()},e.prototype.loadRoomScene=function(){this.lockSubmit=!0,cc.director.loadScene("Room")},e.prototype.initSDK=function(){var t=this;u.isInited()||(console.log("\u6b63\u5728\u521d\u59cb\u5316 SDK"),u.initSDK(a.default.gameId,a.default.secretKey,a.default.url,function(e){e.code===MGOBE.ErrCode.EC_OK?(console.log("\u521d\u59cb\u5316 SDK \u6210\u529f"),l.default.room.onUpdate=function(){return t.onRoomUpdate()}):console.log("\u521d\u59cb\u5316 SDK \u5931\u8d25\uff0c\u9519\u8bef\u7801\uff1a"+e.code)}))},e.prototype.matchPlayers=function(t){var e=this;this.lockSubmit=!0,this.timer=setInterval(function(){return console.log("\u6b63\u5728\u968f\u673a\u5339\u914d\uff0c\u8bf7\u7a0d\u7b49\u3002")},1e3),console.log("\u6b63\u5728\u968f\u673a\u5339\u914d\uff0c\u5339\u914dCode\uff1a"+t+"\u3002\u8bf7\u7a0d\u7b49\uff0c\u9ed8\u8ba4\u8d85\u65f6\u65f6\u95f4\u4e3a 10 \u79d2\u3002");var o={matchCode:t,playerInfo:{name:this.nameRichText.string,customPlayerStatus:0,customProfile:this.user,matchAttributes:[]}};l.default.room.initRoom(),l.default.room.matchPlayers(o,function(t){e.lockSubmit=!1,clearInterval(e.timer),t.code===MGOBE.ErrCode.EC_OK?(console.log("\u968f\u673a\u5339\u914d\u6210\u529f\uff0c\u623f\u95f4ID\uff1a"+t.data.roomInfo.id),e.loadRoomScene()):console.log("\u968f\u673a\u5339\u914d\u5931\u8d25\uff0c\u9519\u8bef\u7801\uff1a"+t.code)})},i([p(cc.Sprite)],e.prototype,"iconSprite",void 0),i([p(cc.Label)],e.prototype,"nameRichText",void 0),i([p(c.default)],e.prototype,"createRoomNode",void 0),i([p(c.default)],e.prototype,"matchNode",void 0),i([p(c.default)],e.prototype,"joinRoomNode",void 0),i([s],e)}(cc.Component);o.default=d,cc._RF.pop()},{"../config":"config","../global":"global","../ui/entryRoomButtton":"entryRoomButtton","../util":"util"}],room_mgr:[function(t,e,o){"use strict";cc._RF.push(e,"ead40Wuxp1K7btyTld3cD0K","room_mgr");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,c=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,n);else for(var u=t.length-1;u>=0;u--)(r=t[u])&&(c=(i<3?r(c):i>3?r(e,o,c):r(e,o))||c);return i>3&&c&&Object.defineProperty(e,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var c=t("../global"),u=cc._decorator,a=u.ccclass,l=u.property,f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.player1Sprite=null,e.player2Sprite=null,e.player1Name=null,e.player2Name=null,e}return r(e,t),e.prototype.onLoad=function(){this.initView()},e.prototype.initView=function(){this.onRoomUpdate()},e.prototype.setRoomView=function(){var t=this,e=c.default.room&&c.default.room.roomInfo||{playerList:[],owner:void 0};e.playerList.map(function(o){var n=JSON.parse(o.customProfile),r=n.nickName,i=n.avatarUrl;o.id===e.owner?(t.player1Name=r,t.createImage(t.player1Sprite,i)):(t.player2Name=r,t.createImage(t.player2Sprite,i))})},e.prototype.createImage=function(t,e){var o=wx.createImage();o.src=e,o.onload=function(){var e=new cc.Texture2D;e.initWithElement(o),t.spriteFrame=new cc.SpriteFrame(e)}},e.prototype.onRoomUpdate=function(){if(!(c.default.room&&c.default.room.roomInfo&&c.default.room.roomInfo.playerList&&c.default.room.roomInfo.playerList.find(function(t){return t.id===MGOBE.Player.id})))return cc.director.loadScene("mgobe");this.setRoomView()},i([l(cc.Sprite)],e.prototype,"player1Sprite",void 0),i([l(cc.Sprite)],e.prototype,"player2Sprite",void 0),i([l(cc.Label)],e.prototype,"player1Name",void 0),i([l(cc.Label)],e.prototype,"player2Name",void 0),i([a],e)}(cc.Component);o.default=f,cc._RF.pop()},{"../global":"global"}],util:[function(t,e,o){"use strict";cc._RF.push(e,"2764bOBgqpHka2lq+jGicrr","util"),Object.defineProperty(o,"__esModule",{value:!0}),o.setBroadcastCallbacks=o.isInited=o.initSDK=void 0;var n=t("./config"),r=t("./global"),i=t("./logic/frame_logic");function c(){return!!MGOBE.Player&&!!MGOBE.Player.id}function u(t,e,o){if(t){var n={onJoinRoom:function(){return function(){return null}},onLeaveRoom:function(){return function(){return null}},onChangeRoom:function(){return function(){return null}},onDismissRoom:function(){return function(){return null}},onStartFrameSync:function(){return function(){return null}},onStopFrameSync:function(){return function(){return null}},onRecvFrame:function(t){i.calcFrame(t.data.frame)},onChangeCustomPlayerStatus:function(){return function(){return null}},onRemovePlayer:function(){return function(){return null}},onRecvFromClient:function(){return function(){return null}},onRecvFromGameSvr:function(){return function(){return null}},onAutoRequestFrameError:function(){return function(){return null}}};Object.keys(n).forEach(function(r){var i=o[r]?o[r].bind(e):n[r];t[r]=i})}}o.initSDK=function(t,e,o,i){if(c())return i&&i({code:MGOBE.ErrCode.EC_OK});var a={gameId:n.default.gameId,openId:n.default.openId,secretKey:n.default.secretKey},l={url:n.default.url,isAutoRequestFrame:!0};Object.assign(a,{gameId:t,secretKey:e}),MGOBE.DebuggerLog.enable=!0,cc.sys.isNative&&(MGOBE.DebuggerLog.enable=!1),MGOBE.Listener.init(a,l,function(t){t.code===MGOBE.ErrCode.EC_OK&&(r.default.room=new MGOBE.Room,r.default.gameId=a.gameId,MGOBE.Listener.add(r.default.room),u(r.default.room,null,{})),i&&i({code:t.code})})},o.isInited=c,o.setBroadcastCallbacks=u,cc._RF.pop()},{"./config":"config","./global":"global","./logic/frame_logic":"frame_logic"}]},{},["config","global","frame_logic","auth_mgr","home_mgr","room_mgr","entryRoomButtton","util"]);